{%- assign _section = section.settings -%}
{%- assign section_aside_enable = _section.aside_enable -%}
{%- assign section_aside_main_title = _section.aside_main_title -%}
{%- assign section_aside_title = _section.aside_title -%}
{%- assign section_aside_title_1 = _section.aside_title_1 -%}
{%- assign section_aside_title_2 = _section.aside_title_2 -%}
{%- assign section_aside_region_1 = _section.aside_region_1 -%}
{%- assign section_aside_region_2 = _section.aside_region_2 -%}
{%- assign section_aside_text_1 = _section.aside_text_1 -%}
{%- assign section_aside_text_2 = _section.aside_text_2 -%}
{%- assign section_aside_text_3 = _section.aside_text_3 -%}
{%- assign section_aside_text_4 = _section.aside_text_4 -%}
{%- assign section_aside_foot = _section.aside_foot -%}
{%- assign section_aside_image = _section.aside_image -%}
{%- assign section_aside_image_two = _section.aside_image_two -%}
{%- assign section_aside_image_three = _section.aside_image_three -%}
{%- assign section_aside_last_image = _section.aside_last_image -%}
{%- assign section_aside_image_position = _section.aside_image_position -%}


{%- assign _blocks = section.blocks -%}
{% assign calendars_slider = '' %}

{%- if _blocks.size > 0 -%}
  {%- capture calendars_slider -%}
    <section id="cal-slider-{{ section.id }}" class="cal-slider">
    </section>
    <div class="section__calendar-images js-slider-calendars">
      {%- for block in _blocks -%}
        {%- assign _block = block.settings -%}
        {%- if _block.image != blank -%}
          <div class="section__calendar-images" {{ block.shopify_attributes }}>
            {{- _block.image | img_url: '750x' | img_tag -}}
          </div>
        {%- endif -%}
      {%- endfor -%}
    </div>
  {%- endcapture -%}
{%- endif -%}

{% if section_aside_enable %}
  <style>
    .section__calendar-title {
      font-size: 24px !important;
      line-height: 33px !important;
      color: #4D4D4D !important;
      font-weight: 400 !important;
      padding: 0 12px;
    }

    .section__calendar-images .slick-dots {
      margin-top: 0 !important;
    }
    .section__aside_main_title p {
      margin-top: 0;
    }
    .section__aside-title {
      color: #4D4D4D !important;
      font-family: "Avenir" !important;
      font-style: normal;
    }
    .section__aside-region {
      font-family: "Avenir" !important;
      font-style: normal;
    }
  </style>

    {% if section_aside_main_title != blank %}
      <h3 class="section__aside_main_title section__calendar-title">
        {{- section_aside_main_title -}}
      </h3>
    {% endif %}
    

  {% if section_aside_image_position == 'above' %}
    {% if _section.calendar_title != blank %}
        <h6 id="calendar-title" class="section__calendar-title">
          {{- _section.calendar_title -}}
        </h6>
      {% endif %}

      {% if _section.calendar_content != blank %}
        <div class="section__calendar-entry">
          {{- _section.calendar_content -}}
        </div>
      {% endif %}

    <!-- TOP BUTTONS -->
    <div class="cal-slider__tabs" role="tablist" aria-label="Kits">
      {%- for block in _blocks -%}
        {%- assign fallback_label = 'Slide ' | append: forloop.index -%}
        {%- assign label = block.settings.month_label
            | default: block.settings.alt
            | default: block.settings.title
            | default: fallback_label -%}
        <button class="cal-tab holiday-aside-button"
                type="button"
                data-slide="{{ forloop.index0 }}"
                role="tab"
                style="--pill-bg: {{ block.settings.pill_color | default: '#B7E66A' }};">
          {{- label -}}
        </button>
      {%- endfor -%}
    </div>
    
    <div class="section__calendar" style="margin-bottom: 30px;">
      {{ calendars_slider }}
    </div>

    <div class="section__aside-foot section__aside-foot1">
        {{- section_aside_foot -}}
        </div>
  {% endif %}


  <div class="section__aside-inner" style="margin-bottom: 30px;">
    {% if section_aside_title != blank %}
      <h3 class="section__aside-title" style="padding: 0 24px;">
        {{- section_aside_title -}}
      </h3>
    {% endif %}

    {% if section_aside_title_1 != blank or section_aside_title_2 != blank %}
      <ul class="list-aside list-aside--red">
        {% if section_aside_title_1 != blank %}
          <li>
            <strong>{{- section_aside_title_1 -}}</strong>
          </li>
        {% endif %}

        {% if section_aside_title_2 != blank %}
          <li>
            <strong>{{- section_aside_title_2 -}}</strong>
          </li>
        {% endif %}
      </ul>
    {% endif %}

    {% if section_aside_region_1 != blank %}
      <p class="section__aside-region">
        {{- section_aside_region_1 -}}
      </p>
    {% endif %}

    {% if section_aside_text_1 != blank %}
      <ul class="list-aside">
        {% if section_aside_text_1 != blank %}
          <li>
            {{- section_aside_text_1 -}}
          </li>
        {% endif %}

        {% if section_aside_text_2 != blank %}
          <li>
            {{- section_aside_text_2 -}}
          </li>
        {% endif %}
      </ul>
    {% endif %}

    {% if section_aside_region_2 != blank %}
      <p class="section__aside-region">
        {{- section_aside_region_2 -}}
      </p>
    {% endif %}

    {% if section_aside_text_3 != blank %}
      <ul class="list-aside">
        {% if section_aside_text_3 != blank %}
          <li>
            {{- section_aside_text_3 -}}
          </li>
        {% endif %}

        {% if section_aside_text_4 != blank %}
          <li>
            {{- section_aside_text_4 -}}
          </li>
        {% endif %}
      </ul>
    {% endif %}
  </div>


  {% if section_aside_image_position == 'below' %}

      {% if _section.calendar_title != blank %}
        <h6 id="calendar-title" class="section__calendar-title">
          {{- _section.calendar_title -}}
        </h6>
      {% endif %}

      {% if _section.calendar_content != blank %}
        <div class="section__calendar-entry">
          {{- _section.calendar_content -}}
        </div>
      {% endif %}

          <!-- TOP BUTTONS -->
    <div class="cal-slider__tabs" role="tablist" aria-label="Kits">
      {%- for block in _blocks -%}
        {%- assign fallback_label = 'Slide ' | append: forloop.index -%}
        {%- assign label = block.settings.month_label
            | default: block.settings.alt
            | default: block.settings.title
            | default: fallback_label -%}
        <button class="cal-tab holiday-aside-button"
                type="button"
                data-slide="{{ forloop.index0 }}"
                role="tab"
                style="--pill-bg: {{ block.settings.pill_color | default: '#B7E66A' }};">
          {{- label -}}
        </button>
      {%- endfor -%}
    </div>
    
    <div class="section__calendar" style="margin-bottom: 30px;">
      {{ calendars_slider }}
    </div>

   
        <div class="section__aside-foot section__aside-foot1">
        {{- section_aside_foot -}}
        </div>


        <div class="section__gift-guide"
       style="max-width: {{ section.settings.max_width }}px; margin-inline:auto; text-align: {{ section.settings.align }};">

    {% if section.settings.aside_last_image != blank %}
      {% if section.settings.btn_link != blank %}
        <a href="{{ section.settings.btn_link }}"
        {% if section.settings.btn_new_tab %}target="_blank" rel="noopener"{% endif %}>
      {% endif %}
      <picture class="image-cta__media">
        <img
          src="{{ section.settings.aside_last_image | image_url: width: 2000 }}"
          alt="{{ section.settings.alt | escape }}"
          loading="lazy"
          width="{{ section.settings.aside_last_image.width }}"
          height="{{ section.settings.aside_last_image.height }}">
      </picture>
      {% if section.settings.btn_link != blank %}
        </a>
      {% endif %}
    {% endif %}

    {% if section.settings.btn_label != blank and section.settings.btn_link != blank %}
      <a class="btn btn-cta" 
      style="width: 301px; margin-top: 30px;"
         href="{{ section.settings.btn_link }}"
         {% if section.settings.btn_new_tab %}target="_blank" rel="noopener"{% endif %}>
        {{ section.settings.btn_label }}
      </a>
    {% endif %}
  </div>
    
  
  {% endif %}
{% endif %}
 
<style>
  .cal-slider__tabs{
    display:flex;
    gap:7px;
    flex-wrap:wrap;
    align-items:center;
    justify-content: center;
    margin:30px 0;
  }
  .cal-tab{
    min-width: 109px;
    height: 45px;
    border-radius:4px;
    border:0; background:var(--pill-bg, #eee); color:#222; cursor:pointer;
    box-shadow:0 1px 0 rgba(0,0,0,.08) inset;
    font-size: 21px;
    font-family: KG HAPPY Solid, sans-serif;
    line-height: 1.3;
    color: #4D4D4D;
  }
  .cal-tab.is-active{  }
  @media (max-width: 767px) {
    .section-holiday-faq .page-width {
        padding: 0 8px;
    }
  }

  @media (max-width:700px){ .cal-slider__tabs{ justify-content:center; } }
    .section__calendar-title{
        text-align:center;
    }
    .section__calendar-entry{
        text-align:center;
    }

    .section__gift-guide {
      display:flex;
      flex-direction:column;
      align-items:center;
      margin-bottom: 71px;
    }

    .image-cta__media img{
      display: block;
      width: 100%;
      height: auto;
    }
    .btn-cta{
      margin-top: 14px;
    }

    @media (min-width: 700px){ .section__aside-foot1 { display:none } }
   
</style>

<script>
(function () {
  const buttons = document.querySelectorAll(".holiday-aside-button");
  [...buttons].forEach((button) => {
    button.addEventListener('click', function() {
      if ($slidersCalendar == null) {
        console.error("$sliderCalendar is empty when clicking slide to button.");
        return;
      }

      const slideIndex = button.dataset.slide;
      
      if (slideIndex == null) {
        console.error("Missing data-slide index on buttons.");
        return;
      }

      $slidersCalendar.slick("slickGoTo", Number(slideIndex), true);
  })
  })
})()
</script>

{% schema %}
{
  "name": "Sidebar",
  "class": "section__aside",
  "settings": [
    {
      "type": "header",
      "content": "Aside Content"
    },
    {
      "type": "checkbox",
      "id": "aside_enable",
      "label": "Enable Box",
      "default": true
    },
    {
      "type": "richtext",
      "id": "aside_main_title",
      "label": "Main Title"
    },
    {
      "type": "richtext",
      "id": "aside_title",
      "label": "Box Title"
    },
    {
      "type": "richtext",
      "id": "aside_title_1",
      "label": "Box subtitle - 1"
    },
    {
      "type": "richtext",
      "id": "aside_title_2",
      "label": "Box subtitle -2"
    },
    {
      "type": "text",
      "id": "aside_region_1",
      "label": "Region 1"
    },
    {
      "type": "text",
      "id": "aside_region_2",
      "label": "Region 2"
    },
    {
      "type": "richtext",
      "id": "aside_text_1",
      "label": "Text Region 1"
    },
    {
      "type": "richtext",
      "id": "aside_text_2",
      "label": "Text Region 2"
    },
    {
      "type": "richtext",
      "id": "aside_text_3",
      "label": "Text Region 3"
    },
    {
      "type": "richtext",
      "id": "aside_text_4",
      "label": "Text Region 4"
    },
    {
      "type": "richtext",
      "id": "aside_foot",
      "label": "Box Foot"
    },
    {
      "type": "textarea",
      "id": "calendar_title",
      "label": "Calendars Title"
    },
    {
      "type": "richtext",
      "id": "calendar_content",
      "label": "Calendars Content"
    },
    {
      "type": "image_picker",
      "id": "aside_last_image",
      "label": "Image"
    },
    { "type": "text", "id": "btn_label", "label": "Button label", "default": "Learn more" },
    { "type": "url", "id": "btn_link", "label": "Button link" },
    {
      "type": "select",
      "id": "aside_image_position",
      "options": [
        {"value": "above", "label": "Above the Calendar"},
        {"value": "below", "label": "Below the Calendar"}
      ],
      "label": "Image Position",
      "default": "below"
    },
    {
      "type": "header",
      "content": "FAQ"
    },
    {
      "type": "paragraph",
      "content": "To add a numbered list, start the numbered list with [numlist] and end with [/numlist]. Then, separate your list items with just an asterisk (*)."
    },
    {
      "type": "paragraph",
      "content": "For example: [numlist]Item 1*Item 2*Item 3*Item 4[/numlist]"
    },
    {
      "type": "paragraph",
      "content": "To add a bulleted list, start the bulleted list with [list] and end with [/list]. Then, separate your list items with just an asterisk (*)."
    },
    {
      "type": "paragraph",
      "content": "For example: [list]Item 1*Item 2*Item 3*Item 4[/list]"
    }
  ],
  "blocks": [
    {
      "type": "calendar",
      "name": "Calendar",
      "settings": [
        {
          "type": "image_picker",
          "id": "image",
          "label": "Image"
        },
        { "type": "text", "id": "alt", "label": "Alt text" },
        { "type": "text", "id": "month_label", "label": "Top button label" },
        { "type": "color", "id": "pill_color", "label": "Top button color", "default": "#B7E66A" }
      ]
    }
  ]
}
{% endschema %}