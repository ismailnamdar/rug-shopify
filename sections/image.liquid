<section id="image-section-{{ section.id }}" class="swap-image">
  <style>
    #image-section-{{ section.id }} .swap-image__inner {
      {% if section.settings.full_width %}
        max-width: none;
      {% else %}
        max-width: {{ section.settings.max_width }}px;
        margin: 0 auto;
      {% endif %}
      {% if section.settings.margin_y %}
        margin: {{ section.settings.margin_y }}px auto;
      {% endif %}
    }
    #image-section-{{ section.id }} .swap-image__picture,
    #image-section-{{ section.id }} .swap-image__img {
      display: block;
      width: 100%;
      height: auto;
    }
  </style>

  <div class="swap-image__inner">
    {% if section.settings.desktop_image != blank %}
      {% if section.settings.mobile_image != blank %}
        <picture class="swap-image__picture">
          <source
            media="(max-width: 749px)"
            srcset="
              {{ section.settings.mobile_image | image_url: width: 480 }} 480w,
              {{ section.settings.mobile_image | image_url: width: 720 }} 720w,
              {{ section.settings.mobile_image | image_url: width: 960 }} 960w,
              {{ section.settings.mobile_image | image_url: width: 1200 }} 1200w
            "
            sizes="(max-width: 749px) 100vw, 0px"
          >
          <img
            class="swap-image__img"
            alt="{{ section.settings.alt_text | escape }}"
            loading="lazy"
            src="{{ section.settings.desktop_image | image_url: width: 1600 }}"
            srcset="
              {{ section.settings.desktop_image | image_url: width: 640 }} 640w,
              {{ section.settings.desktop_image | image_url: width: 960 }} 960w,
              {{ section.settings.desktop_image | image_url: width: 1280 }} 1280w,
              {{ section.settings.desktop_image | image_url: width: 1600 }} 1600w,
              {{ section.settings.desktop_image | image_url: width: 2000 }} 2000w
            "
            sizes="(max-width: 749px) 0px, 100vw"
            width="{{ section.settings.desktop_image.width }}"
            height="{{ section.settings.desktop_image.height }}"
          >
        </picture>
      {% else %}
        {{ section.settings.desktop_image | image_url: width: 1200 | image_tag: 
            widths: '400, 800, 1200, 1600, 2000',
            loading: 'lazy',
            alt: section.settings.alt_text 
        }}
      {% endif %}
    {% else %}
      <div style="aspect-ratio: 16/9; background: #f2f2f2; display:flex; align-items:center; justify-content:center;">
        <span style="opacity:.6;">Add an image in the section settings</span>
      </div>
    {% endif %}
  </div>
</section>

{% schema %}
{
  "name": "Image (Desktop/Mobile)",
  "settings": [
    {
      "type": "image_picker",
      "id": "desktop_image",
      "label": "Desktop image"
    },
    {
      "type": "image_picker",
      "id": "mobile_image",
      "label": "Mobile image (optional)"
    },
    {
      "type": "text",
      "id": "alt_text",
      "label": "Alt text (accessibility)"
    },
    {
      "type": "range",
      "id": "max_width",
      "min": 320,
      "max": 1200,
      "step": 20,
      "unit": "px",
      "label": "Max content width",
      "default": 1200
    },
    {
      "type": "checkbox",
      "id": "full_width",
      "label": "Make section full width",
      "default": false
    },
    { "type": "range", "id": "margin_y", "label": "Vertical margin (px)", "min": 0, "max": 120, "step": 5, "default": 20 }
  ],
  "presets": [
    {
      "name": "Image (Desktop/Mobile)"
    }
  ]
}
{% endschema %}

