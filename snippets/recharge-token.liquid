<script>
  document.addEventListener("DOMContentLoaded", function() {
    fetch("/tools/recurring/get_rc_token/{{customer.id}}")
      .then(res => res.clone().text())
      .then(data => {
        const rc_customer = JSON.parse(data.match(/{"rc_customer":.*}}/g)[0]);
        if(rc_customer.rc_customer && rc_customer.rc_customer.token) {
          $("[data-recharge-token]").each(function(index, el) {
            $(el).attr("href", $(el).attr("href") + '?token' + rc_customer.rc_customer.token)
          })
        }
      })
  })
</script>